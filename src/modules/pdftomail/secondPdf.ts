import { Request, Response } from "express";
import { generate } from "@pdfme/generator";
import { Designer, Form, Viewer } from "@pdfme/ui";
import { Template, BLANK_PDF } from "@pdfme/common";
import AWS from "aws-sdk";
import {
  text,
  image,
  barcodes,
  line,
  readOnlyText,
  readOnlyImage,
  tableBeta,
} from "@pdfme/schemas";
import config from "../../config";
import { PDFDocument } from "pdf-lib"; // Temporarily using pdf-lib for merging
import { images } from "./images";
import { PdfDataModel } from "./pdf.model";

// Configure AWS
AWS.config.update({
  accessKeyId: config.aws_access_key_id,
  secretAccessKey: config.aws_secret_access_key,
  region: config.aws_region,
  signatureVersion: "v4",
});

const s3 = new AWS.S3();

const secondPdf = async (req: Request, res: Response) => {
  try {
    const {
      userName,
      CC,
      savingType,
      UserUID,
      typeOfContract,
      totalDepositValue,
      company,
    } = req.body;

    const isexists = await PdfDataModel.findOne({ UserUID });

    if (isexists) {
      const result = await PdfDataModel.updateOne(
        { UserUID: UserUID },
        {
          $set: {
            userName: userName,
            CC: CC,
            savingType: savingType,
            typeOfContract: typeOfContract,
            totalDepositValue: totalDepositValue,
            company: company,
          },
        }
      );
    } else {
      const result = await PdfDataModel.create({
        userName,
        UserUID,
        CC,
        typeOfContract,
        savingType,
        totalDepositValue,
        company,
      });
    }

    // --------------------------------------------------date
    // Get current date and time in Colombian time zone
    const currentDate = new Date();

    // Options for formatting date to get components
    const options: Intl.DateTimeFormatOptions = {
      day: "2-digit",
      month: "numeric",
      year: "numeric",
      timeZone: "America/Bogota",
    };

    // Format the date using the options
    const formattedDateParts = new Intl.DateTimeFormat(
      "es-ES",
      options
    ).formatToParts(currentDate);

    // Extract and map the parts, with default values to avoid undefined
    const day =
      formattedDateParts.find((part) => part.type === "day")?.value || "01";
    const month =
      formattedDateParts.find((part) => part.type === "month")?.value || "1";
    const year =
      formattedDateParts.find((part) => part.type === "year")?.value || "2024";

    // Define month names in uppercase (in Spanish)
    const monthNames = [
      "ENERO",
      "FEBRERO",
      "MARZO",
      "ABRIL",
      "MAYO",
      "JUNIO",
      "JULIO",
      "AGOSTO",
      "SEPTIEMBRE",
      "OCTUBRE",
      "NOVIEMBRE",
      "DICIEMBRE",
    ];

    // Convert month number to month name (adjust index by -1 since array is 0-based)
    const monthIndex = parseInt(month) - 1;
    const monthName = monthNames[monthIndex] || "ENERO";

    // Combine the parts to get the desired format
    const formattedDate = `${day} ${monthName} ${year}`;
    const plugins = {
      text,
      image,
      readOnlyImage,
      qrcode: barcodes.qrcode,
      line,
      readOnlyText,
      tableBeta,
    };

    const template1: Template = {
      schemas: [
        {
          HEAD: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content: "CONTRATO DE AHORRO - LINEAS",
            position: { x: 65.7, y: 27.8 },
            width: 78.6,
            height: 6.29,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          HEADTWO: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content: "FIMUTUAL",
            position: { x: 91.37, y: 37.8 },
            width: 27.27,
            height: 6.29,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          SIDETEXT: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content: "Fecha:",
            position: { x: 175.11, y: 47.8 },
            width: 15.89,
            height: 6.29,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 12,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          TABLEHEADER: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content: "Informaci√≥n de Titularidad del asociado",
            position: { x: 63.06, y: 60.8 },
            width: 83.89,
            height: 6.29,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 12,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          TABLE: {
            type: "table",
            position: { x: 19.56, y: 74.24 },
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-table"><path d="M12 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M3 9h18"/><path d="M3 15h18"/></svg>',
            width: 170.89,
            height: 68.6936,
            content:
              '[["Direccion Domicilio","DATO AUTOMANTIOO"],["Paisde nacimiento","DATO AUTOMANTIOO"],["Tipo Documento","DATO AUTOMANTIOO"],["Fecha de nacimiento","DATO AUTOMANTIOO"],["Email","DATO AUTOMANTIOO"],["Numero de documento","DATO AUTOMANTIOO"],["Fecha y lugarde expedidion documento","DATO AUTOMANTIOO"],["Telefono","DATO AUTOMANTIOO"]]',
            showHead: true,
            head: ["Nombresy apellidos", "DATO AUTOMANTIOO"],
            headWidthPercentages: [46.63146584804297, 53.36853415195703],
            tableStyles: { borderWidth: 0.3, borderColor: "#000000" },
            headStyles: {
              fontName: "NotoSerifJP-Regular",
              fontSize: 10,
              characterSpacing: 0,
              alignment: "left",
              verticalAlignment: "middle",
              lineHeight: 0.7,
              fontColor: "#000000",
              borderColor: "",
              backgroundColor: "#ffffff",
              borderWidth: { top: 0, right: 0, bottom: 0, left: 0 },
              padding: { top: 3, right: 5, bottom: 3, left: 5 },
            },
            bodyStyles: {
              fontName: "NotoSerifJP-Regular",
              fontSize: 10,
              characterSpacing: 0,
              alignment: "left",
              verticalAlignment: "middle",
              lineHeight: 1,
              fontColor: "#000000",
              borderColor: "#888888",
              backgroundColor: "",
              alternateBackgroundColor: "#f5f5f5",
              borderWidth: {
                top: 0.1,
                right: 0.1,
                bottom: 0.1,
                left: 0.1,
              },
              padding: { top: 2, right: 5, bottom: 2, left: 5 },
            },
            columnStyles: { alignment: { "0": "left", "1": "center" } },
          },
          H3: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content: "CLAUSULAS",
            position: { x: 89.91, y: 153.8 },
            width: 30.18,
            height: 6.29,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          TEXTONE: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "ASOCIADO, con la firma de este contrato de apertura de LINEA DEAHORRO, confirmo que acepto las siguientes clausulas:",
            position: { x: 20.28, y: 163.74 },
            width: 171.46,
            height: 16.87,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.5,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          TEXTTWO: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "PRIMERO: La informaci√≥n aqu√≠ suministrada por m√≠ es confidencial ynecesaria para la vinculaci√≥n como asociado ahorrador en FIMUTUAL, lagesti√≥n y aprobaci√≥n de cualquier producto u operaci√≥n y/o la atenci√≥ndemis solicitudes, peticiones, quejas o reclamos. Declaro que la informaci√≥nsuministrada en el Sitio Web o la Aplicaci√≥n es de mi titularidad, concuerdacon la realidad y asumo plena responsabilidad por la veracidad deesta;\ncualquier inexactitud podr√° acarrear las consecuencias expuestas enel\nReglamento de productos, sin responsabilidad alguna por parte de FIMUTUAL, frente a terceros. Reconozco y acepto que en el evento que la informaci√≥npor",
            position: { x: 20.28, y: 180.74 },
            width: 171.46,
            height: 77.72,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.5,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          footerOne: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "Este documento incorpora firma electronica, de acuerdo a la ley N¬∞ 51 de 22de",
            position: { x: 17.68, y: 268.42 },
            width: 174.64,
            height: 8.41,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
          },
          footerTwo: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content: "julio 2008",
            position: { x: 93.75, y: 275.42 },
            width: 22.5,
            height: 7.61,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
        },
      ],
      basePdf: { width: 210, height: 297, padding: [0, 0, 0, 0] },
    };

    const template2: Template = {
      schemas: [
        {
          TEXTONE: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "m√≠ suministrada en este Sitio Web o aplicaci√≥n no sea de mi propiedad,\ninduzca a una falsedad personal o sea violatoria del bien jur√≠dico tuteladodenominado ‚Äúde la protecci√≥n de la informaci√≥n y de los datos‚Äù podr√© incurrir en tipos penales previstos por la legislaci√≥n colombiana.",
            position: { x: 19.24, y: 17.53 },
            width: 171.26,
            height: 31.96,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.6,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          TEXTTWO: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "As√≠ mismo, entiendo que autorizo a FIMUTUAL con relaci√≥n a:",
            position: { x: 19.24, y: 62.53 },
            width: 171.52,
            height: 10,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.4,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          TEXTTHREE: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "I. Autorizaci√≥n Reporte y Consulta de Informaci√≥n ante los OperadoresdeBancos de Datos de Informaci√≥n Financiera y/o Crediticia (Ley 1266de2008y Ley 2157 de 2021). Autorizo de FIMUTUAL, como responsabledel\nTratamiento; sus Encargados del Tratamiento; a quien √©l les haya transmitidoo transferido la informaci√≥n, incluyendo la transferencia a terceros pa√≠ses, aliados, y/o a quien el futuro ostente sus derechos, para que obtenga todalainformaci√≥n relativa a mis datos personales financieros, crediticios, comerciales y de servicios registrados ante cualquier banco de datos, mi\ncomportamiento crediticio y comercial, el cumplimiento de mis obligaciones, en el sector financiero y real, datos financieros e informaci√≥n relacionadaconmi situaci√≥n laboral e ingresos salariales ante operadores de informaci√≥ncrediticia, de seguridad social, administradoras de fondos y cesant√≠as, centrales de riesgo, notar√≠as, Registradur√≠a Nacional del EstadoCivil, Contralor√≠a General de la Rep√∫blica, Procuradur√≠a General de la Naci√≥n, DIAN, Oficinas de Registro, cajas de compensaci√≥n, proveedores tecnol√≥gicosdeN√≥mina y Facturaci√≥n electr√≥nica, Administradoras de Fondos de Pensionesyde Cesant√≠as y Operadores de Informaci√≥n a trav√©s de las cuales se liquidancesant√≠as, aportes de seguridad social y parafiscales, tales como AportesenL√≠nea, SOI, SIMPLE, PILA, entre otras; as√≠ mismo para que solicitenoverifiquen informaci√≥n sobre mis activos, bienes o derechos en entidadesp√∫blicas o privadas, o informaci√≥n que se encuentre en buscadores p√∫blicos,",
            position: { x: 19.24, y: 74.53 },
            width: 171.26,
            height: 178.01,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.6,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          footerOne: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "Este documento incorpora firma electronica, de acuerdo a la ley N¬∞ 51 de 22de",
            position: { x: 17.68, y: 268.42 },
            width: 174.64,
            height: 8.41,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
          },
          footerTwo: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content: "julio 2008",
            position: { x: 93.75, y: 275.42 },
            width: 22.5,
            height: 7.61,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
        },
      ],
      basePdf: { width: 210, height: 297, padding: [0, 0, 0, 0] },
    };

    const template3: Template = {
      schemas: [
        {
          TEXTONE: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "listas restrictivas, listas vinculantes para Colombia, redes socialesopublicaciones f√≠sicas o electr√≥nicas, bien fuere en Colombia o en el exterior. El resultado del an√°lisis para acceder al producto me ser√° informado atrav√©sde alguno de los medios de contacto que he suministrado. De igual manera, autorizo, para que, con fines estad√≠sticos, de control, supervisi√≥nydeinformaci√≥n, reporte a las Centrales de Informaci√≥n, mis datos de contacto, el\ndesarrollo, novedades, extinci√≥n y cumplimiento de las obligaciones contra√≠daso que llegue a contraer con FIMUTUAL y/o a quien el futuro ostentesusderechos. Estas autorizaciones de reporte y consulta de informaci√≥n tendr√°nlas mismas finalidades leg√≠timas estipuladas para el tratamientodeinformaci√≥n personal cuya autorizaci√≥n y detalle se se√±ala a continuaci√≥n.",
            position: { x: 19.24, y: 21.53 },
            width: 171.26,
            height: 97.57,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.6,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          TEXTTHREE: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "II. Autorizaci√≥n para el Tratamiento de la Informaci√≥n Personal (Ley 1581 de2012). Sin perjuicio del derecho que me asiste a escoger los canalesdecontacto y habiendo sido debidamente informado sobre los mediosdecomunicaci√≥n que ser√°n utilizados por FIMUTUAL para el ejerciciodelarelaci√≥n contractual y comercial, autorizo de manera libre, voluntaria, expresae informada a FIMUTUAL en calidad de Responsable del Tratamiento; asusencargados del tratamiento o a quien la asociaci√≥n les haya transmitidootransferido la informaci√≥n, incluyendo la transferencia a terceros pa√≠ses, y/oaquien en el futuro ostente sus derechos, a ser contactado utilizandolainformaci√≥n suministrada en el presente Formulario para las finalidadesprevistas en este documento, a trav√©s de los siguientes canales: i) l√≠neatelef√≥nica; ii) correo electr√≥nico; iii) Servicio de Mensajes Cortos (SMS); iv)\naplicaciones de mensajer√≠a instant√°nea o formal; y/o v) redes sociales. Declaro conocer y entender que, en caso de que requiera actualizar omodificar mis canales de contacto, puedo realizarlo a trav√©s de las L√≠neasautorizadas e informadas en la p√°gina WEB de la asociaci√≥n. Autorizoa",
            position: { x: 19.24, y: 123.53 },
            width: 171.26,
            height: 134.35,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.6,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          footerOne: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "Este documento incorpora firma electronica, de acuerdo a la ley N¬∞ 51 de 22de",
            position: { x: 17.68, y: 268.42 },
            width: 174.64,
            height: 8.41,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
          },
          footerTwo: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content: "julio 2008",
            position: { x: 93.75, y: 275.42 },
            width: 22.5,
            height: 7.61,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
        },
      ],
      basePdf: { width: 210, height: 297, padding: [0, 0, 0, 0] },
    };

    const template4: Template = {
      schemas: [
        {
          TEXTONE: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "FIMUTUAL, en calidad de responsable del Tratamiento; a sus Encargadosdel\nTratamiento o a quien haya transmitido o transferido la informaci√≥n, aliadosy/o a quien el futuro ostente sus derechos, incluyendo la transferenciaaterceros pa√≠ses, y/o a quien en el futuro ostente sus derechos, para quellevea cabo el tratamiento de mis datos personales, incluyendo datos biom√©tricos. En virtud de dicha autorizaci√≥n de tratamiento, FIMUTUAL podr√° solicitar, consultar, compartir, recolectar, almacenar, informar, usar, circular, reportar, transferir, trasmitir, procesar, divulgar, rectificar, modificar, aclarar, retirar, suprimir y/o actualizar mis datos e informaci√≥n personal, la cual, essuministrada por m√≠ a trav√©s de todos los canales de contacto con FIMUTUAL, as√≠ como la p√°gina web. As√≠ mismo, autorizo a FIMUTUAL, en calidadderesponsable del Tratamiento; a sus Encargados del Tratamiento o a quien√©l\nles haya transmitido o transferido la informaci√≥n, aliados, incluyendolatransferencia a terceros pa√≠ses, y/o a quien el futuro ostente sus derechos, para que de forma directa o a trav√©s de una entidad certificadacomooperador biom√©trico, realice la validaci√≥n de mi identidad y mis caracter√≠sticasf√≠sicas (huellas dactilares y/o rostro). Declaro que conozco y entiendoquenoestoy obligado a suministrar y/o autorizar el tratamiento de los datospersonales de menores de edad. De igual manera, declaro que conozcoyentiendo que no estoy obligado a suministrar y/o autorizar el tratamientodedatos personales sensibles; no obstante, autorizo a FIMUTUAL el tratamientode estos datos, de conformidad con lo establecido en el Art√≠culo 5 y 6delaLey 1581 de 2023 y el Art√≠culo 6 del Decreto 1377 de 2013, incluyendodeforma expresa mis datos biom√©tricos y los datos asociados al origen racial o√©tnico, exclusivamente para las finalidades previstas en el presentedocumento; as√≠ mismo, conozco que la informaci√≥n biom√©trica consultadaenlas bases de datos respectivas no podr√° ser almacenada, ni usadaporaplicaciones de mensajer√≠a instant√°nea o formal; y/o v) redes sociales. Declaro conocer y entender que, en caso de que requiera actualizar omodificar mis canales de contacto, puedo realizarlo a trav√©s de las L√≠neasautorizadas e informadas en la p√°gina WEB de la asociaci√≥n. Autorizoa",
            position: { x: 19.24, y: 18.53 },
            width: 171.26,
            height: 245.47,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.6,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          footerOne: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "Este documento incorpora firma electronica, de acuerdo a la ley N¬∞ 51 de 22de",
            position: { x: 17.68, y: 268.42 },
            width: 174.64,
            height: 8.41,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
          },
          footerTwo: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content: "julio 2008",
            position: { x: 93.75, y: 275.42 },
            width: 22.5,
            height: 7.61,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
        },
      ],
      basePdf: { width: 210, height: 297, padding: [0, 0, 0, 0] },
      pdfmeVersion: "4.0.0",
    };

    const template5: Template = {
      schemas: [
        {
          TEXTONE: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "FIMUTUAL, sus Encargados del Tratamiento o a quien √©l les haya transmitidoo transferido la informaci√≥n, aliados, incluyendo la transferencia a tercerospa√≠ses y/o a quien el futuro ostente sus derechos, para complementar otrasbases de datos, ni para fines distintos a los expresados en la presenteautorizaci√≥n y en la Ley. Mis datos e informaci√≥n personal, debidamenteautorizados a trav√©s del presente formulario, podr√°n ser sujetosdetratamiento por FIMUTUAL, sus Encargados del Tratamiento o a quien√©l leshaya transmitido o transferido la informaci√≥n, aliados, incluyendolatransferencia a terceros pa√≠ses y/o a quien el futuro ostente sus derechos, enconsecuencia, acepto ser contactado(a) mediante: i) l√≠nea telef√≥nica; ii) correoelectr√≥nico; iii) Servicio de Mensajes Cortos (SMS); iv) v) aplicacionesdemensajer√≠a instant√°nea o formal; y/o vi) redes sociales. El tratamientopor lapresente autorizaci√≥n permitido a FIMUTUAL, sus Encargados del Tratamientoo a quien √©l les haya transmitido o transferido la informaci√≥n, aliados,\nincluyendo la transferencia a terceros pa√≠ses y/o a quien el futuro ostentesusderechos podr√° tener por objeto las finalidades legitimas de: i) cumplir lasobligaciones contractuales y reglamentarias, prevenci√≥n del lavado de activosy financiaci√≥n del terrorismo, as√≠ como para la prestaci√≥n de los servicioscontratados; ii) atender y dar soluci√≥n a las solicitudes, peticiones, quejasoreclamos formulados a FIMUTUAL; iii) crear y actualizar los perfilestransaccionales; iv) realizar gestiones de cobranza; v) informar sobreloscambios realizados a los productos y servicios del portafolio de FIMUTUAL; vi)\nanalizar las tendencias y comportamientos de consumo de los consumidoresfinancieros; vii) para mi vinculaci√≥n como cliente y/o prospecto, aprobaci√≥nde operaciones de cr√©dito, apertura y/o uso de los servicios y/o productosofrecidos por FIMUTUAL; viii) recibir informaci√≥n sobre campa√±as, estrategias promocionales, ofertas comerciales y publicidad de productosde",
            position: { x: 19.24, y: 21.53 },
            width: 171.26,
            height: 224.04,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.6,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          footerOne: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "Este documento incorpora firma electronica, de acuerdo a la ley N¬∞ 51 de 22de",
            position: { x: 17.68, y: 268.42 },
            width: 174.64,
            height: 8.41,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
          },
          footerTwo: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content: "julio 2008",
            position: { x: 93.75, y: 275.42 },
            width: 22.5,
            height: 7.61,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
        },
      ],
      basePdf: { width: 210, height: 297, padding: [0, 0, 0, 0] },
      pdfmeVersion: "4.0.0",
    };

    const template6: Template = {
      schemas: [
        {
          TEXTONE: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "FIMUTUAL y de aliados de √©ste, sean √©stas presentes o futuras; ix) recibir\ncualquier tipo de informaci√≥n y/o comunicaci√≥n que FIMUTUALestimenecesario y general, para que se adelanten todos los procesosderelacionamiento (soportados o no en tecnolog√≠a), para un abordajeyconocimiento integral del cliente de todos mis productos y solucionescontratadas con FIMUTUAL, entre otros permitidos por la Ley. Conozcoyentiendo que como Titular de la informaci√≥n tengo derecho a conocer, actualizar, rectificar mis datos personales, solicitar prueba de la autorizaci√≥notorgada para el tratamiento de la informaci√≥n, informarme sobre el usoquese ha dado a los mismos, revocar la autorizaci√≥n, solicitar la supresi√≥ndemisdatos cuando sea procedente y acceder en forma gratuita a los mismos. Conozco que, para ejercer los derechos sobre mis datos personales podr√©comunicarme a las L√≠neas de Atenci√≥n suministradas en la p√°gina WEB. Paraconocer la Pol√≠tica de Protecci√≥n de Datos Personales y Pol√≠tica de Cobranzas, podr√© ingresar a la pagina WEB.",
            position: { x: 19.24, y: 21.53 },
            width: 171.26,
            height: 112.91,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.6,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          "TEXTONE copy": {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "III. Autorizaci√≥n para Compartir Datos Personales con EntidadesPertenecientes al Grupo Econ√≥mico, vinculados econ√≥micos, personasjur√≠dicas o naturales, con base en las disposiciones de FIMUTUAL. AutorizoaFIMUTUAL y/o a cualquier otra Entidad o Unidad de Negocio internaquerepresente sus derechos, a compartir mi informaci√≥n personal, financiera, crediticia y comercial como Cliente de FIMUTUAL con cualquiera otra personao Entidad Vinculada al Grupo Econ√≥mico al que pertenece y/o llegueapertenecer FIMUTUAL o la Entidad que represente sus derechos, para realizar\nel mismo tratamiento y con las mismas finalidades mencionadas en el numeral\nanterior. Declaro haber le√≠do el contenido de este documento, as√≠ comocomprenderlo en su alcance e implicaci√≥n, aceptando los T√©rminosyCondiciones. El documento y mi aceptaci√≥n tendr√°n validez marcandola",
            position: { x: 19.24, y: 141.53 },
            width: 171.26,
            height: 112.91,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.6,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          footerOne: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "Este documento incorpora firma electronica, de acuerdo a la ley N¬∞ 51 de 22de",
            position: { x: 17.68, y: 268.42 },
            width: 174.64,
            height: 8.41,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
          },
          footerTwo: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content: "julio 2008",
            position: { x: 93.75, y: 275.42 },
            width: 22.5,
            height: 7.61,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
        },
      ],
      basePdf: { width: 210, height: 297, padding: [0, 0, 0, 0] },
      pdfmeVersion: "4.0.0",
    };

    const template7: Template = {
      schemas: [
        {
          TEXTONE: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "casilla de aceptaci√≥n en el formulario de solicitud de FIMUTUAL y/o dequienen el futuro represente u ostente sus derechos, as√≠ como, sus obligaciones. Las definiciones contenidas en la presente autorizaci√≥n que se encuentrenenmay√∫scula tendr√°n el significado que as√≠ se haya determinado en la Pol√≠ticade Protecci√≥n de Datos Personales de FIMUTUAl, la cual podr√° ser consultadaen la p√°gina web.",
            position: { x: 19.24, y: 21.53 },
            width: 171.26,
            height: 46.23,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.6,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          "TEXTONE copy": {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "SEGUNDO: Declaraci√≥n de origen de Fondos- Declaro que: a.) Mis recursostienen un origen l√≠cito y provienen directamente del desarrollo de la actividadecon√≥mica y ocupaci√≥n se√±alada en la secci√≥n actividad econ√≥mica. b.) Losingresos aqu√≠ reportados, no provienen de ninguna actividad il√≠cita delascontempladas en el c√≥digo penal colombiano o en cualquier otra normaconcordante. c.) No admitir√© que terceros efect√∫en dep√≥sitos a nombrem√≠oen los productos solicitados, de los cuales desconozca su origen.",
            position: { x: 19.24, y: 73.53 },
            width: 171.26,
            height: 60.52,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.6,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          "TEXTONE copy 2": {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "TERCERO: Acepto el reglamento de AHORRO FIMUTUAL, Acuerdo002aprobado por junta directiva, el cual me fue informado durante el procesorealizado.",
            position: { x: 19.24, y: 141.53 },
            width: 171.26,
            height: 23.21,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.6,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          "TEXTONE copy 3": {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "CUARTO: Acepto que los extractos y otras comunicaciones con FIMUTUALsean enviadas al buz√≥n de mi servicio a trav√©s de la APP o pagina WEB",
            position: { x: 19.24, y: 171.53 },
            width: 171.26,
            height: 23.21,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.6,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          "TEXTONE copy 4": {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "QUINTO: Declaro que no soy una persona expuesta pol√≠ticamente en Colombiani en ning√∫n pa√≠s diferente a Colombia, ni soy c√≥nyuge, ni familiar hastael\nsegundo grado de consanguinidad o segundo de afinidad o primerocivil deuna persona expuesta pol√≠ticamente. Igualmente declaro que noestoycobijado por el articulo 30-A de la Ley 1908 de 2019, ni tengo residenciafiscal en ning√∫n pa√≠s diferente a Colombia.",
            position: { x: 19.24, y: 202.53 },
            width: 171.26,
            height: 54.43,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.6,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          footerOne: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "Este documento incorpora firma electronica, de acuerdo a la ley N¬∞ 51 de 22de",
            position: { x: 17.68, y: 268.42 },
            width: 174.64,
            height: 8.41,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
          },
          footerTwo: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content: "julio 2008",
            position: { x: 93.75, y: 275.42 },
            width: 22.5,
            height: 7.61,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
        },
      ],
      basePdf: { width: 210, height: 297, padding: [0, 0, 0, 0] },
      pdfmeVersion: "4.0.0",
    };

    const template8: Template = {
      schemas: [
        {
          TEXTONE: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "SEXTO: En observancia del art√≠culo 7 del Decreto 2364 de 2012, convengocon FIMUTUAL y acepto que el presente documento ser√° firmadoelectr√≥nicamente mediante el mecanismo OTP (One Time Password) digitadoen un dispositivo m√≥vil, ordenador u otra herramienta que autorice FIMUTUAL, reconociendo que dicha firma tiene los mismos efectos de mi firmamanuscrita, cumpliendo con los atributos dispuestos en el par√°grafodel\nart√≠culo 28 de la Ley 527 de 1999 y el citado Decreto Reglamentario. Paraestos efectos, manifiesto que: I). Le√≠ y verifiqu√© el presente documento; II). Mantendr√© actualizados en todo momento los datos del celular personal yel\ncorreo electr√≥nico; III). Y reportar√© de forma inmediata cualquier circunstanciaque pueda poner en riesgo la seguridad de la OTP. Para todos los efectos, losdocumentos firmados electr√≥nicamente ser√°n custodiados por FIMUTUALy/ola empresa que haga sus veces en este proceso.",
            position: { x: 19.24, y: 23.53 },
            width: 171.26,
            height: 100.73,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1.6,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
          footerOne: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content:
              "Este documento incorpora firma electronica, de acuerdo a la ley N¬∞ 51 de 22de",
            position: { x: 17.68, y: 268.42 },
            width: 174.64,
            height: 8.41,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
          },
          footerTwo: {
            type: "readOnlyText",
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-type"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>',
            content: "julio 2008",
            position: { x: 93.75, y: 275.42 },
            width: 22.5,
            height: 7.61,
            rotate: 0,
            alignment: "left",
            verticalAlignment: "top",
            fontSize: 13,
            lineHeight: 1,
            characterSpacing: 0,
            fontColor: "#000000",
            backgroundColor: "",
            opacity: 1,
            readOnly: true,
            fontName: "NotoSerifJP-Regular",
          },
        },
      ],
      basePdf: { width: 210, height: 297, padding: [0, 0, 0, 0] },
      pdfmeVersion: "4.0.0",
    };

    // second template -----------------------------------------

    const input1 = [
      {
        HEAD: "CONTRATO DE AHORRO - LINEAS",
        HEADTWO: "FIMUTUAL",
        SIDETEXT: "Fecha:",
        TABLEHEADER: "readOnlyText",
        TABLE:
          '[["Direccion Domicilio","DATO AUTOMANTIOO"],["Paisde nacimiento","DATO AUTOMANTIOO"],["Tipo Documento","DATO AUTOMANTIOO"],["Fecha de nacimiento","DATO AUTOMANTIOO"],["Email","DATO AUTOMANTIOO"],["Numero de documento","DATO AUTOMANTIOO"],["Fecha y lugarde expedidion documento","DATO AUTOMANTIOO"],["Telefono","DATO AUTOMANTIOO"]]',
        H3: "CLAUSULAS",
        TEXTONE: "readOnlyText",
        TEXTTWO:
          "PRIMERO: La informaci√≥n aqu√≠ suministrada por m√≠ es confidencial ynecesaria para la vinculaci√≥n como asociado ahorrador en FIMUTUAL, lagesti√≥n y aprobaci√≥n de cualquier producto u operaci√≥n y/o la atenci√≥ndemis solicitudes, peticiones, quejas o reclamos. Declaro que la informaci√≥nsuministrada en el Sitio Web o la Aplicaci√≥n es de mi titularidad, concuerdacon la realidad y asumo plena responsabilidad por la veracidad deesta;\ncualquier inexactitud podr√° acarrear las consecuencias expuestas enel\nReglamento de productos, sin responsabilidad alguna por parte de FIMUTUAL, frente a terceros. Reconozco y acepto que en el evento que la informaci√≥npor",
      },
    ];

    const input2 = [
      {
        TEXTONE:
          "m√≠ suministrada en este Sitio Web o aplicaci√≥n no sea de mi propiedad,\ninduzca a una falsedad personal o sea violatoria del bien jur√≠dico tuteladodenominado ‚Äúde la protecci√≥n de la informaci√≥n y de los datos‚Äù podr√© incurrir en tipos penales previstos por la legislaci√≥n colombiana.",
        TEXTTWO: "As√≠ mismo, entiendo que autorizo a FIMUTUAL con relaci√≥n a:",
        TEXTTHREE:
          "I. Autorizaci√≥n Reporte y Consulta de Informaci√≥n ante los OperadoresdeBancos de Datos de Informaci√≥n Financiera y/o Crediticia (Ley 1266de2008y Ley 2157 de 2021). Autorizo de FIMUTUAL, como responsabledel\nTratamiento; sus Encargados del Tratamiento; a quien √©l les haya transmitidoo transferido la informaci√≥n, incluyendo la transferencia a terceros pa√≠ses, aliados, y/o a quien el futuro ostente sus derechos, para que obtenga todalainformaci√≥n relativa a mis datos personales financieros, crediticios, comerciales y de servicios registrados ante cualquier banco de datos, mi\ncomportamiento crediticio y comercial, el cumplimiento de mis obligaciones, en el sector financiero y real, datos financieros e informaci√≥n relacionadaconmi situaci√≥n laboral e ingresos salariales ante operadores de informaci√≥ncrediticia, de seguridad social, administradoras de fondos y cesant√≠as, centrales de riesgo, notar√≠as, Registradur√≠a Nacional del EstadoCivil, Contralor√≠a General de la Rep√∫blica, Procuradur√≠a General de la Naci√≥n, DIAN, Oficinas de Registro, cajas de compensaci√≥n, proveedores tecnol√≥gicosdeN√≥mina y Facturaci√≥n electr√≥nica, Administradoras de Fondos de Pensionesyde Cesant√≠as y Operadores de Informaci√≥n a trav√©s de las cuales se liquidancesant√≠as, aportes de seguridad social y parafiscales, tales como AportesenL√≠nea, SOI, SIMPLE, PILA, entre otras; as√≠ mismo para que solicitenoverifiquen informaci√≥n sobre mis activos, bienes o derechos en entidadesp√∫blicas o privadas, o informaci√≥n que se encuentre en buscadores p√∫blicos,",
      },
    ];

    // Generate both PDFs
    const pdf1 = await generate({
      template: template1,
      plugins,
      inputs: input1,
    });
    const pdf2 = await generate({
      template: template2,
      plugins,
      inputs: input2,
    });
    const pdf3 = await generate({
      template: template3,
      plugins,
      inputs: input1,
    });
    const pdf4 = await generate({
      template: template4,
      plugins,
      inputs: input1,
    });
    const pdf5 = await generate({
      template: template5,
      plugins,
      inputs: input1,
    });
    const pdf6 = await generate({
      template: template6,
      plugins,
      inputs: input1,
    });
    const pdf7 = await generate({
      template: template7,
      plugins,
      inputs: input1,
    });
    const pdf8 = await generate({
      template: template8,
      plugins,
      inputs: input1,
    });

    // Load both PDFs into PDF-lib
    const pdfDoc1 = await PDFDocument.load(pdf1);
    const pdfDoc2 = await PDFDocument.load(pdf2);
    const pdfDoc3 = await PDFDocument.load(pdf3);
    const pdfDoc4 = await PDFDocument.load(pdf4);
    const pdfDoc5 = await PDFDocument.load(pdf5);
    const pdfDoc6 = await PDFDocument.load(pdf6);
    const pdfDoc7 = await PDFDocument.load(pdf7);
    const pdfDoc8 = await PDFDocument.load(pdf8);

    // Create a new PDF document
    const mergedPdf = await PDFDocument.create();

    // Copy pages from the first PDF document 1
    const copiedPages1 = await mergedPdf.copyPages(
      pdfDoc1,
      pdfDoc1.getPageIndices()
    );
    copiedPages1.forEach((page) => {
      mergedPdf.addPage(page);
    });

    // Copy pages from the second PDF document 2
    const copiedPages2 = await mergedPdf.copyPages(
      pdfDoc2,
      pdfDoc2.getPageIndices()
    );
    copiedPages2.forEach((page) => {
      mergedPdf.addPage(page);
    });

    // Copy pages from the second PDF document 3
    const copiedPages3 = await mergedPdf.copyPages(
      pdfDoc3,
      pdfDoc3.getPageIndices()
    );
    copiedPages3.forEach((page) => {
      mergedPdf.addPage(page);
    });

    // Copy pages from the second PDF document 4
    const copiedPages4 = await mergedPdf.copyPages(
      pdfDoc4,
      pdfDoc4.getPageIndices()
    );
    copiedPages4.forEach((page) => {
      mergedPdf.addPage(page);
    });

    // Copy pages from the second PDF document 5
    const copiedPages5 = await mergedPdf.copyPages(
      pdfDoc5,
      pdfDoc5.getPageIndices()
    );
    copiedPages5.forEach((page) => {
      mergedPdf.addPage(page);
    });

    // Copy pages from the second PDF document 6
    const copiedPages6 = await mergedPdf.copyPages(
      pdfDoc6,
      pdfDoc6.getPageIndices()
    );
    copiedPages6.forEach((page) => {
      mergedPdf.addPage(page);
    });

    // Copy pages from the second PDF document 7
    const copiedPages7 = await mergedPdf.copyPages(
      pdfDoc7,
      pdfDoc7.getPageIndices()
    );
    copiedPages7.forEach((page) => {
      mergedPdf.addPage(page);
    });

    // Copy pages from the second PDF document 8
    const copiedPages8 = await mergedPdf.copyPages(
      pdfDoc8,
      pdfDoc8.getPageIndices()
    );
    copiedPages8.forEach((page) => {
      mergedPdf.addPage(page);
    });

    // Serialize the merged PDF to bytes (Buffer)
    const mergedPdfBytes = await mergedPdf.save();

    // Define the upload parameters
    const uploadParams = {
      Bucket: "upload-pdf-v33",
      Key: `pdfs/${Date.now()}-output.pdf`,
      Body: Buffer.from(mergedPdfBytes),
      ContentType: "application/pdf",
    };

    // Upload the merged PDF to S3
    s3.upload(uploadParams, async (uploadErr: any, data: any) => {
      if (uploadErr) {
        console.error("Error uploading to S3:", uploadErr);
        return res.status(500).json({
          success: false,
          message: "Failed to upload PDF to S3",
          error: uploadErr,
        });
      }

      // Generate a pre-signed URL for the uploaded PDF
      const signedUrl = await s3.getSignedUrlPromise("getObject", {
        Bucket: "upload-pdf-v33",
        Key: uploadParams.Key,
        Expires: 60 * 5, // Link expires in 5 minutes
      });

      res.json({
        downloadUrl: signedUrl,
        message: "PDF generated and uploaded successfully",
      });
    });
  } catch (error) {
    console.error("Unexpected error:", error);
    res.status(500).json({
      success: false,
      message: "Something went wrong!",
      error: error,
    });
  }
};

export const SecondPdfController = {
  secondPdf,
};
